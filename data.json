import json
from datetime import datetime

# DADOS CORRETOS
dados_raw = [
    ("RECURSOS HUMANOS", 14549944.75, 9358526.35),
    ("PROCESSOS TRABALHISTA", 0.00, 2944.00),
    ("MATERIAIS DE CONSUMO", 3085899.09, 599300.63),
    ("SERVIÇOS DE TERCEIROS", 13583505.23, 3412043.98),
    ("LOCAÇÃO", 813390.00, 96530.36),
    ("INVESTIMENTOS", 382950.00, 1329727.83),
    ("Combustível", 500.00, 43201.59),
    ("Utilidades, Energia, Água, coleta de lixo e internet", 7000.00, 547260.90),
    ("Despesas financeiras e bancárias", 200.00, 3410.29),
    ("Outras despesas", 5500.00, 413947.91),
    ("Despesas de Rateio", 90000.00, 9358526.35),
    ("Apoio Técnico", 0.00, 411601.13),
    ("Custas Processos Judiciais", 3000.00, 0.00),
    ("Despesas Administrativas", 1000.00, 0.00),
]

categorias = []
total_fuabc = 0
total_sesaud = 0

for categoria, fuabc, sesaud in dados_raw:
    categorias.append({
        "categoria": categoria,
        "fuabc": round(fuabc, 2),
        "sesaud": round(sesaud, 2),
        "diferenca": round(sesaud - fuabc, 2),
        "percentual_diff": round(((sesaud - fuabc) / fuabc * 100) if fuabc > 0 else 0, 1)
    })
    total_fuabc += fuabc
    total_sesaud += sesaud

total_geral = total_fuabc + total_sesaud
percentual_fuabc = round((total_fuabc / total_geral * 100), 1)
percentual_sesaud = round((total_sesaud / total_geral * 100), 1)

dados_dashboard = {
    "resumo": {
        "total_fuabc": round(total_fuabc, 2),
        "total_sesaud": round(total_sesaud, 2),
        "total_geral": round(total_geral, 2),
        "diferenca": round(total_sesaud - total_fuabc, 2),
        "percentual_fuabc": percentual_fuabc,
        "percentual_sesaud": percentual_sesaud,
        "percentual_diff": round(((total_sesaud - total_fuabc) / total_fuabc * 100), 1)
    },
    "categorias": categorias,
    "atualizado_em": datetime.now().strftime("%d/%m/%Y %H:%M:%S"),
    "timestamp": datetime.now().isoformat()
}

json_str = json.dumps(dados_dashboard, ensure_ascii=False, indent=2)
print(json_str)
