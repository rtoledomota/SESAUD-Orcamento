import json
from datetime import datetime

print("="*80)
print("EXTRAIR JSON CORRETO")
print("="*80 + "\n")

# DADOS CORRETOS
dados_raw = [
    ("RECURSOS HUMANOS", 14549944.75, 9358526.35),
    ("PROCESSOS TRABALHISTA", 0.00, 2944.00),
    ("MATERIAIS DE CONSUMO", 3085899.09, 599300.63),
    ("SERVI√áOS DE TERCEIROS", 13583505.23, 3412043.98),
    ("LOCA√á√ÉO", 813390.00, 96530.36),
    ("INVESTIMENTOS", 382950.00, 1329727.83),
    ("Combust√≠vel", 500.00, 43201.59),
    ("Utilidades, Energia, √Ågua, coleta de lixo e internet", 7000.00, 547260.90),
    ("Despesas financeiras e banc√°rias", 200.00, 3410.29),
    ("Outras despesas", 5500.00, 413947.91),
    ("Despesas de Rateio", 90000.00, 9358526.35),
    ("Apoio T√©cnico", 0.00, 411601.13),
    ("Custas Processos Judiciais", 3000.00, 0.00),
    ("Despesas Administrativas", 1000.00, 0.00),
]

categorias = []
total_fuabc = 0
total_sesaud = 0

for categoria, fuabc, sesaud in dados_raw:
    categorias.append({
        "categoria": categoria,
        "fuabc": round(fuabc, 2),
        "sesaud": round(sesaud, 2),
        "diferenca": round(sesaud - fuabc, 2),
        "percentual_diff": round(((sesaud - fuabc) / fuabc * 100) if fuabc > 0 else 0, 1)
    })
    total_fuabc += fuabc
    total_sesaud += sesaud

total_geral = total_fuabc + total_sesaud
percentual_fuabc = round((total_fuabc / total_geral * 100), 1)
percentual_sesaud = round((total_sesaud / total_geral * 100), 1)

dados_dashboard = {
    "resumo": {
        "total_fuabc": round(total_fuabc, 2),
        "total_sesaud": round(total_sesaud, 2),
        "total_geral": round(total_geral, 2),
        "diferenca": round(total_sesaud - total_fuabc, 2),
        "percentual_fuabc": percentual_fuabc,
        "percentual_sesaud": percentual_sesaud,
        "percentual_diff": round(((total_sesaud - total_fuabc) / total_fuabc * 100), 1)
    },
    "categorias": categorias,
    "atualizado_em": datetime.now().strftime("%d/%m/%Y %H:%M:%S"),
    "timestamp": datetime.now().isoformat()
}

print("1. JSON CORRETO GERADO\n")
print(f"   Total FUABC: R$ {total_fuabc:,.2f}")
print(f"   Total SESAUD: R$ {total_sesaud:,.2f}")
print(f"   Categorias: {len(categorias)}\n")

print("="*80)
print("COPIE APENAS ISTO (O JSON PURO):")
print("="*80 + "\n")

json_str = json.dumps(dados_dashboard, ensure_ascii=False, indent=2)
print(json_str)

print("\n" + "="*80)
print("PASSOS PARA ATUALIZAR NO GITHUB:")
print("="*80 + "\n")

print("""
PASSO 1: ABRIR data.json NO GITHUB

Clique aqui:
https://github.com/rtoledomota/SESAUD-Orcamento/blob/main/data.json

PASSO 2: CLIQUE NO L√ÅPIS (EDIT)

No canto superior direito, clique em ‚úèÔ∏è Edit

PASSO 3: APAGAR TUDO

Pressione: Ctrl + A (seleciona tudo)
Pressione: Delete (apaga tudo)

PASSO 4: COLAR O JSON

Acima, eu mostrei o JSON CORRETO.

Fa√ßa isto:
1. Selecione TODO o JSON acima (Ctrl+A)
2. Copie (Ctrl+C)
3. No GitHub, clique na caixa
4. Cole (Ctrl+V)

PASSO 5: COMMIT

Scroll para baixo
Clique "Commit changes"
Deixe a mensagem padr√£o
Clique "Commit" novamente

PRONTO! ‚úÖ

Dashboard atualiza em 30 segundos!

Depois:
1. Abra: https://rtoledomota.github.io/SESAUD-Orcamento/
2. Pressione: Ctrl + Shift + R
3. Me avisa se atualizou!

FACA AGORA! üëá
""")
